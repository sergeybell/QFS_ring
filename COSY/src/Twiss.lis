 --- BIN FILE READ: seq_QFS_16_small_maps
  10906 INCLUDE 'seq_QFS_16_small_maps';
  10907   PROCEDURE PICK INDEX MAPARR SPNRARR;
  10908     VARIABLE I 1;
  10909     VARIABLE J 1;
  10910     LOOP I 1 TWOND;
  10911       MSC(I) := MAPARR(I, INDEX);
  10912       ENDLOOP;
  10913     LOOP I 1 3;
  10914       LOOP J 1 3;
  10915         SSCR(I,J) := SPNRARR(I,J,INDEX) + 0*DD(1);
  10916         ENDLOOP;
  10917       ENDLOOP;
  10918     ENDPROCEDURE;
  10919   PROCEDURE MAKEMAP FROM TO START MAPARR SPNRARR;
  10920     VARIABLE J 1;
  10921     WRITE 6 '* '&ST(START);
  10922     LMAPS START MAPARR SPNRARR; %LMAPS:10125
  10923     LOOP J (START+1) TO;
  10924       WRITE 6 '**       '&ST(J);
  10925       PICK J MAPARR SPNRARR; %PICK:10907
  10926       LOCSET 0 0 0 0 0 0; %LOCSET: 1114
  10927       UPDATE 1 1; %UPDATE: 1261
  10928       ENDLOOP;
  10929     LOOP J FROM (START-1);
  10930       WRITE 6 '**       '&ST(J);
  10931       PICK J MAPARR SPNRARR; %PICK:10907
  10932       LOCSET 0 0 0 0 0 0; %LOCSET: 1114
  10933       UPDATE 1 1; %UPDATE: 1261
  10934       ENDLOOP;
  10935     ENDPROCEDURE;
  10936   PROCEDURE GETTWISS0 COORD AL0 BET0 GAM0 MAPARR SPNRARR;
  10937     VARIABLE NUM1 1;
  10938     VARIABLE NUM2 1;
  10939     VARIABLE OBJ 1;
  10940     IF COORD='X';
  10941       NUM1:=1;
  10942       NUM2:=2;
  10943       AL0:=0;
  10944       BET0:=20.0;
  10945       GAM0:=1.0/BET0;
  10946       ELSEIF COORD='Y';
  10947       NUM1:=3;
  10948       NUM2:=4;
  10949       AL0:=0;
  10950       BET0:=3;
  10951       GAM0:=1.0/BET0;
  10952       ELSEIF LO(1);
  10953       WRITE 6 'UNKNOWN COORDINATE';
  10954       ENDIF;
  10955     FIT AL0 BET0 GAM0;
  10956       OBJ:= SQR(SQR(ME(NUM1,NUM1))*BET0-2*ME(NUM1,NUM1)*ME(NUM1,NUM2)*
                  AL0+SQR(ME(NUM1,NUM2))*GAM0-BET0); %ME:  516 %ME:  516 %ME: 
                   516 %ME:  516
  10957       OBJ:=OBJ+ SQR(-ME(NUM1,NUM1)*ME(NUM2,NUM1)*BET0+( ME(NUM1,NUM1)*
                  ME(NUM2,NUM2)+ME(NUM1,NUM2)*ME(NUM2,NUM1) )*AL0-ME(NUM1,NUM2
                  )*ME(NUM2,NUM2)*GAM0-AL0); %ME:  516 %ME:  516 %ME:  516 %ME
                  :  516 %ME:  516 %ME:  516 %ME:  516 %ME:  516
  10958       OBJ:=OBJ+ SQR((ME(NUM2,NUM1)^2)*BET0-2*ME(NUM2,NUM1)*ME(NUM2,NUM
                  2)*AL0+(ME(NUM2,NUM2)^2)*GAM0-(1+AL0^2)/BET0)  ; %ME:  516 %
                  ME:  516 %ME:  516 %ME:  516
  10959       ENDFIT 1E-20 5000 1 OBJ;
  10960     ENDPROCEDURE;
  10961   PROCEDURE BETS TAG COORD NUM_ELE AL0 BET0 GAM0 BETS MAPARR SPNRARR;
  10962     VARIABLE J 1;
  10963     VARIABLE NUM1 1;
  10964     VARIABLE NUM2 1;
  10965     IF COORD='X';
  10966       NUM1:=1;
  10967       NUM2:=2;
  10968       ELSEIF COORD='Y';
  10969       NUM1:=3;
  10970       NUM2:=4;
  10971       ELSEIF LO(1);
  10972       WRITE 6 'UNKNOWN COORDINATE';
  10973       ENDIF;
  10974     UM; %UM: 1488
  10975     BETS(1):=BET0;
  10976     OPENF 800 TAG 'REPLACE';
  10977     WRITE 800 ST(BETS(1))&'     '&ST(0);
  10978     LOOP J 1 NUM_ELE;
  10979       MAKEMAP 1 J 1 MAPARR SPNRARR; %MAKEMAP:10919
  10980       BETS(J+1):=(ME(NUM1,NUM1)^2)*BET0-2*ME(NUM1,NUM1)*ME(NUM1,NUM2)*
                  AL0+(ME(NUM1,NUM2)^2)*GAM0; %ME:  516 %ME:  516 %ME:  516 %M
                  E:  516
  10981       WRITE 800 ST(BETS(J+1))&'     '&ST(J);
  10982       UM; %UM: 1488
  10983       ENDLOOP;
  10984     CLOSEF 800;
  10985     ENDPROCEDURE;
  10986   PROCEDURE GETDISP0 COORD D0 DPR0 MAPARR SPNRARR;
  10987     VARIABLE NUM1 1;
  10988     VARIABLE NUM2 1;
  10989     VARIABLE OBJ 1;
  10990     IF COORD='X';
  10991       NUM1:=1;
  10992       NUM2:=2;
  10993       D0:=0;
  10994       DPR0:=0;
  10995       ELSEIF COORD='Y';
  10996       NUM1:=3;
  10997       NUM2:=4;
  10998       D0:=0;
  10999       DPR0:=0;
  11000       ELSEIF LO(1);
  11001       WRITE 6 'UNKNOWN COORDINATE';
  11002       ENDIF;
  11003     FIT D0 DPR0;
  11004       OBJ:= SQR(  ME(NUM1,NUM1)*D0+ME(NUM1,NUM2)*DPR0+ME(NUM1,6)*(1+1/
                  (CONS(ETA)+1))-D0  ); %ME:  516 %ME:  516 %ME:  516
  11005       OBJ:=OBJ+ SQR(  ME(NUM2,NUM1)*D0+ME(NUM2,NUM2)*DPR0+ME(NUM2,6)*(
                  1+1/(CONS(ETA)+1))-DPR0  )  ; %ME:  516 %ME:  516 %ME:  516
  11006       ENDFIT 1E-20 5000 1 OBJ;
  11007     WRITE 6 'DISP'&COORD&'0' 'DISP_PRIME'&COORD&'0';
  11008     WRITE 6 D0 DPR0;
  11009     ENDPROCEDURE;
  11010   PROCEDURE DISPS TAG COORD NUM_ELE D0 DPR0 DS MAPARR SPNRARR;
  11011     VARIABLE J 1;
  11012     VARIABLE NUM1 1;
  11013     VARIABLE NUM2 1;
  11014     IF COORD='X';
  11015       NUM1:=1;
  11016       NUM2:=2;
  11017       ELSEIF COORD='Y';
  11018       NUM1:=3;
  11019       NUM2:=4;
  11020       ELSEIF LO(1);
  11021       WRITE 6 'UNKNOWN COORDINATE';
  11022       ENDIF;
  11023     UM; %UM: 1488
  11024     DS(1):=D0;
  11025     OPENF 800 TAG 'REPLACE';
  11026     WRITE 800 ST(DS(1))&'     '&ST(0);
  11027     LOOP J 1 NUM_ELE;
  11028       MAKEMAP 1 J 1 MAPARR SPNRARR; %MAKEMAP:10919
  11029       DS(J+1):=ME(NUM1,NUM1)*D0+ME(NUM1,NUM2)*DPR0+ ME(NUM1,6)*(1+1/(C
                  ONS(ETA)+1)); %ME:  516 %ME:  516 %ME:  516
  11030       WRITE 800 ST(DS(J+1))&'     '&ST(J);
  11031       UM; %UM: 1488
  11032       ENDLOOP;
  11033     CLOSEF 800;
  11034     ENDPROCEDURE;
  11035   PROCEDURE MAIN;
  11036     VARIABLE GAMMA 1;
  11037     VARIABLE SGX1 1;
  11038     VARIABLE SGX2 1;
  11039     VARIABLE SGY1 1;
  11040     VARIABLE SGY2 1;
  11041     VARIABLE EB1 1;
  11042     VARIABLE ALPHAX0 1;
  11043     VARIABLE BETAX0 1;
  11044     VARIABLE GAMMAX0 1;
  11045     VARIABLE BETAXS 1 313;
  11046     VARIABLE ALPHAY0 1;
  11047     VARIABLE BETAY0 1;
  11048     VARIABLE GAMMAY0 1;
  11049     VARIABLE BETAYS 1 313;
  11050     VARIABLE DISPX0 1;
  11051     VARIABLE DISPXPR0 1;
  11052     VARIABLE DISPXS 1 313;
  11053     VARIABLE DISPY0 1;
  11054     VARIABLE DISPYPR0 1;
  11055     VARIABLE DISPYS 1 313;
  11056     VARIABLE MAPARR1 1000 6 313;
  11057     VARIABLE SPNRARR1 1000 3 3 313;
  11058     VARIABLE NUM_ELE 1;
  11059     VARIABLE TILT 48;
  11060     GAMMA := 1.143914;
  11061     NUM_ELE := 70;
  11062     OV 3 3 0; %OV:  969
  11063     SET_FOR_DEUTERONS GAMMA; %SET_FOR_DEUTERONS:10611
  11064     EB1 := 89.04;
  11065     SGX1 :=  0.0;
  11066     SGY1  := 0.0;
  11067     SGX2 :=  0.0;
  11068     SGY2  := 0.0;
  11069     BETAX0 :=1.00311;
  11070     BETAY0 :=4.26415;
  11071     ALPHAX0:=0.0;
  11072     ALPHAY0:=0.0;
  11073     GAMMAX0:=(1+SQR(ALPHAX0))/BETAX0;
  11074     GAMMAY0:=(1+SQR(ALPHAY0))/BETAY0;
  11075     DISPX0  :=0.0;
  11076     DISPXPR0:=0.0;
  11077     DISPY0  :=0.0;
  11078     DISPYPR0:=0.0;
  11079     LATTICE SGX1 SGY1 SGX2 SGY1 EB1 0 MAPARR1 SPNRARR1; %LATTICE:10648

  11080     PM 6; %PM: 1574
  11081     WRITE 6 '++++++++++ Magnetic Rigidity';
  11082     WRITE 6 CONS(CHIM);
  11083     WRITE 6 ME(3,6); %ME:  516
  11084     BETS 'BETAX' 'X' NUM_ELE ALPHAX0 BETAX0 GAMMAX0 BETAXS MAPARR1 SPN
                  RARR1; %BETS:10961
  11085     BETS 'BETAY' 'Y' NUM_ELE ALPHAY0 BETAY0 GAMMAY0 BETAYS MAPARR1 SPN
                  RARR1; %BETS:10961
  11086     DISPS 'DISPX' 'X' NUM_ELE DISPX0 DISPXPR0 DISPXS MAPARR1 SPNRARR1;
                   %DISPS:11010
  11087     ENDPROCEDURE;
  11088   PROCEDURE RUN;
  11089     MAIN; %MAIN:11035
  11090     ENDPROCEDURE;
  11091   RUN; %RUN:11088
