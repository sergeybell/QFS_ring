 --- BIN FILE READ: cosy
   9753 INCLUDE 'cosy';
   9754   PROCEDURE DIRSET_AUTO VAL;
   9755     VARIABLE DIRSETFLAG 1;
   9756     DIRSETFLAG := VAL;
   9757     ENDPROCEDURE;
   9758   PROCEDURE DIRSET VAR PATH;
   9759     VARIABLE ANS 1;
   9760     VARIABLE DIRSETFLAG 1;
   9761     VAR := PATH;
   9762     OS 'mkdir -p '&PATH;
   9763     WRITE 6 'WRITING TO: '&PATH;
   9764     IF DIRSETFLAG=0;
   9765       WRITE 6 '********** DIRECTORY GOOD? [Y/N]';
   9766       READ 5 ANS;
   9767       IF (ANS#'Y')*(ANS#'y');
   9768         WRITE 6 'QUITTING ... ';
   9769         QUIT 1;
   9770         ENDIF;
   9771       WRITE 6 '***** REMOVE EXISTING FILES? [Y/N]';
   9772       READ 5 ANS;
   9773       IF (ANS='Y')+(ANS='y');
   9774         OS 'rm -vf '&PATH&'*';
   9775         ENDIF;
   9776       ENDIF;
   9777     ENDPROCEDURE;
   9778   FUNCTION FILENAME WHERE NAME MARKER;
   9779     VARIABLE SEP 1;
   9780     SEP := ':';
   9781     IF MARKER='';
   9782       SEP:='';
   9783       ENDIF;
   9784     FILENAME := WHERE&NAME&SEP&MARKER&'.dat';
   9785     ENDFUNCTION;
   9786   FUNCTION MRK I;
   9787     MRK := LTRIM(SF(I, '(I10)')); %SF:  285
   9788     ENDFUNCTION;
   9789   FUNCTION FORM VEC;
   9790     VARIABLE FMT 10;
   9791     VARIABLE I 1;
   9792     FMT := '(E15.7)';
   9793     FORM:='';
   9794     LOOP I 1 LENGTH(VEC);
   9795       FORM := FORM&SF(VEC|I, FMT); %SF:  285
   9796       ENDLOOP;
   9797     ENDFUNCTION;
   9798   PROCEDURE WRITETBL OU ARR NARR MARKER;
   9799     VARIABLE NVEC 1;
   9800     VARIABLE I 1;
   9801     VARIABLE J 1;
   9802     VARIABLE ROW 101;
   9803     NVEC := LENGTH(ARR(1));
   9804     LOOP I 1 NVEC;
   9805       ROW := ARR(1)|I;
   9806       LOOP J 2 NARR;
   9807         ROW := ROW&(ARR(J)|I);
   9808         ENDLOOP;
   9809       WRITE OU MARKER&' '&MRK(I-1)&' '&FORM(ROW); %MRK: 9786 %FORM: 97
                  89
   9810       ENDLOOP;
   9811     ENDPROCEDURE;
   9812   FUNCTION ZEROS NUM;
   9813     VARIABLE I 1;
   9814     VARIABLE RES NUM;
   9815     RES := 0;
   9816     LOOP I 2 NUM;
   9817       RES := RES&0;
   9818       ENDLOOP;
   9819     ZEROS:=RES;
   9820     ENDFUNCTION;
   9821   FUNCTION ONES NUM;
   9822     VARIABLE I 1;
   9823     VARIABLE RES NUM;
   9824     RES := 1;
   9825     LOOP I 2 NUM;
   9826       RES := RES&1;
   9827       ENDLOOP;
   9828     ONES:=RES;
   9829     ENDFUNCTION;
   9830   PROCEDURE EYE MAT M;
   9831     VARIABLE I 1;
   9832     VARIABLE J 1;
   9833     LOOP I 1 M;
   9834       LOOP J 1 M;
   9835         MAT(I,J) := 0*DD(1);
   9836         ENDLOOP;
   9837       MAT(I,I) := 1 + 0*DD(1);
   9838       ENDLOOP;
   9839     ENDPROCEDURE;
   9840   FUNCTION LINSPACE LOW HIGH NUM;
   9841     VARIABLE I 1;
   9842     VARIABLE DELTA 1;
   9843     VARIABLE RES NUM;
   9844     RES := LOW;
   9845     IF NUM>1;
   9846       DELTA := (HIGH-LOW)/(NUM-1);
   9847       LOOP I 2 NUM;
   9848         RES := RES&(LOW + DELTA*(I-1));
   9849         ENDLOOP;
   9850       ENDIF;
   9851     LINSPACE := RES;
   9852     ENDFUNCTION;
   9853   FUNCTION RAD2DEG ANGLE;
   9854     RAD2DEG := ANGLE/DEGRAD;
   9855     ENDFUNCTION;
   9856   FUNCTION DEG2RAD ANGLE;
   9857     DEG2RAD := ANGLE*DEGRAD;
   9858     ENDFUNCTION;
   9859   FUNCTION VEGAUSS MEAN SIGMA NUM PATH;
   9860     VARIABLE VAL 1;
   9861     OS 'python gauss.py '&ST(MEAN)&' '&ST(SIGMA)&SF(NUM,'(I10)')&' '&P
                  ATH&'.in'; %SF:  285
   9862     OPENF 100500 PATH&'.in' 'OLD';
   9863     READ 100500 VAL;
   9864     WHILE ST(VAL)#'';
   9865       VEGAUSS:=VEGAUSS&VAL;
   9866       READ 100500 VAL;
   9867       ENDWHILE;
   9868     CLOSEF 100500;
   9869     VEGAUSS := VEGAUSS|(2&LENGTH(VEGAUSS));
   9870     ENDFUNCTION;
   9871   FUNCTION COV X Y;
   9872     VARIABLE N 1;
   9873     VARIABLE MUX 1;
   9874     VARIABLE MUY 1;
   9875     IF LENGTH(X)=LENGTH(Y);
   9876       N := LENGTH(X);
   9877       ELSEIF TRUE;
   9878       WRITE 6 'DIFFERENT VECTOR LENGTHS!!!';
   9879       ENDIF;
   9880     MUX := RE(X);
   9881     MUY := RE(Y);
   9882     COV := RE((X-MUX)*(Y-MUY));
   9883     ENDFUNCTION;
   9884   FUNCTION EMITTANCE X1 X2;
   9885     VARIABLE COVS 1 2 2;
   9886     VARIABLE I 1;
   9887     VARIABLE J 1;
   9888     VARIABLE DET 1;
   9889     COVS(1,1) := COV(X1,X2); %COV: 9871
   9890     COVS(1,2) := COV(X1,X2); %COV: 9871
   9891     COVS(2,1) := COVS(1,2);
   9892     COVS(2,2) := COV(X2,X2); %COV: 9871
   9893     DET := COVS(1,1)*COVS(2,2) - COVS(2,1)*COVS(1,2);
   9894     EMITTANCE := SQRT(DET);
   9895     ENDFUNCTION;
   9896   PROCEDURE GET_TUNE_ENSEMBLE MUARR;
   9897     VARIABLE K 1;
   9898     VARIABLE MU 5000;
   9899     VARIABLE NBAR 5000 3;
   9900     TSS MU NBAR 0; %TSS: 4289
   9901     MUARR(1) := MU;
   9902     LOOP K 1 3;
   9903       MUARR(K+1) := NBAR(K);
   9904       ENDLOOP;
   9905     POLVAL 1 MUARR 4 RAY TWOND MUARR 4;
   9906     ENDPROCEDURE;
   9907   FUNCTION REVFREQ LCIR;
   9908     REVFREQ := CONS(V0)/LCIR;
   9909     ENDFUNCTION;
   9910   FUNCTION STD VEC;
   9911     VARIABLE MEAN 1;
   9912     VARIABLE N 1;
   9913     MEAN := RE(VEC);
   9914     N := LENGTH(VEC) - 1;
   9915     STD := SQRT(ABS(SQR(VEC-MEAN))/N);
   9916     ENDFUNCTION;
   9917   FUNCTION BETA GAMMA;
   9918     BETA := SQRT(GAMMA*GAMMA - 1)/GAMMA;
   9919     ENDFUNCTION;
   9920   PROCEDURE GET_BOUNDS X Y XMIN XMAX YMIN YMAX DX DY;
   9921     VARIABLE N 1;
   9922     N := LENGTH(X);
   9923     XMIN := VMIN(X);
   9924     XMAX := VMAX(X);
   9925     YMIN := VMIN(Y);
   9926     YMAX := VMAX(Y);
   9927     DX := (XMAX-XMIN)/(NRAY-2);
   9928     DY := (YMAX-YMIN)/(NRAY-2);
   9929     ENDPROCEDURE;
   9930   PROCEDURE FRAME_SETUP X Y PLOT TITLE;
   9931     VARIABLE FMT 10;
   9932     VARIABLE XMIN 1;
   9933     VARIABLE XMAX 1;
   9934     VARIABLE YMIN 1;
   9935     VARIABLE YMAX 1;
   9936     VARIABLE DX 1;
   9937     VARIABLE DY 1;
   9938     FMT := '(E9.3)';
   9939     GET_BOUNDS X Y XMIN XMAX YMIN YMAX DX DY; %GET_BOUNDS: 9920
   9940     FG PLOT XMIN XMAX YMIN YMAX DX DY TITLE 0; %FG: 2694
   9941     GRMOVE (XMIN-1.2*DX) YMIN 0 PLOT;
   9942     GRCHAR SF(XMIN, FMT) PLOT; %SF:  285
   9943     GRMOVE XMIN (YMIN-DY*.5)  0 PLOT;
   9944     GRCHAR SF(YMIN, FMT) PLOT; %SF:  285
   9945     GRMOVE (XMAX-DX) YMIN 0 PLOT;
   9946     GRCHAR SF(XMAX, FMT) PLOT; %SF:  285
   9947     GRMOVE XMAX YMAX  0 PLOT;
   9948     GRCHAR SF(YMAX, FMT) PLOT; %SF:  285
   9949     ENDPROCEDURE;
   9950   PROCEDURE DRAW_LAYER XVEC YVEC PLOT;
   9951     VARIABLE N 1;
   9952     VARIABLE X 1 1000;
   9953     VARIABLE Y 1 1000;
   9954     VARIABLE I 1;
   9955     N := LENGTH(XVEC);
   9956     LOOP I 1 N;
   9957       X(I) := XVEC|I;
   9958       Y(I) := YVEC|I;
   9959       GRDOT X(I) Y(I) 0 PLOT;
   9960       ENDLOOP;
   9961     ENDPROCEDURE;
   9962   PROCEDURE AM1 M S;
   9963     VARIABLE I 1 ;
   9964     VARIABLE J 1;
   9965     UMS; %UMS: 1469
   9966     LOOP I 1 TWOND ;
   9967       MSC(I) := M(I) ;
   9968       ENDLOOP ;
   9969     LOOP I 1 3;
   9970       LOOP J 1 3;
   9971         SSCR(I,J) := S(I,J);
   9972         ENDLOOP;
   9973       ENDLOOP;
   9974     LOCSET 0 0 0 0 0 0 ; %LOCSET: 1114
   9975     UPDATE 1 1 ; %UPDATE: 1261
   9976     ENDPROCEDURE;
   9977   PROCEDURE MATPROD N M O;
   9978     VARIABLE I 1;
   9979     VARIABLE J 1;
   9980     LOOP I 1 3;
   9981       LOOP J 1 3;
   9982         O(I,J) := N(I,1)*M(1,J) + N(I,2)*M(2,J) + N(I,3)*M(3,J);
   9983         ENDLOOP;
   9984       ENDLOOP;
   9985     ENDPROCEDURE;
   9986   PROCEDURE S3NM N M;
   9987     VARIABLE I 1;
   9988     VARIABLE J 1;
   9989     LOOP I 1 3;
   9990       LOOP J 1 3;
   9991         M(I,J) := N(I,J);
   9992         ENDLOOP;
   9993       ENDLOOP;
   9994     ENDPROCEDURE;
   9995   FUNCTION VEREV VEC;
   9996     VARIABLE N 1;
   9997     VARIABLE NMID 1;
   9998     VARIABLE I 1;
   9999     VARIABLE DUM 1;
  10000     VARIABLE RES LENGTH(VEC);
  10001     N := LENGTH(VEC);
  10002     RES := VEC;
  10003     IF MOD(N, 2)=0; %MOD:  210
  10004       NMID := N/2;
  10005       ELSEIF LO(1);
  10006       NMID := INT(N/2);
  10007       ENDIF;
  10008     LOOP I 1 NMID;
  10009       VELGET RES (N-I+1) DUM;
  10010       VELSET RES (N-I+1) RES|I;
  10011       VELSET RES I DUM;
  10012       ENDLOOP;
  10013     VEREV := RES;
  10014     ENDFUNCTION;
  10015   PROCEDURE MATINV M1 M2;
  10016     VARIABLE MDET 4000;
  10017     MDET:=0;
  10018     MDET:=MDET+M1(1,1)*(M1(2,2)*M1(3,3)-M1(2,3)*M1(3,2));
  10019     MDET:=MDET-M1(2,1)*(M1(1,2)*M1(3,3)-M1(1,3)*M1(3,2));
  10020     MDET:=MDET+M1(3,1)*(M1(1,2)*M1(2,3)-M1(1,3)*M1(2,2));
  10021     M2(1,1):=(M1(2,2)*M1(3,3)-M1(2,3)*M1(3,2))/MDET;
  10022     M2(2,2):=(M1(1,1)*M1(3,3)-M1(1,3)*M1(3,1))/MDET;
  10023     M2(3,3):=(M1(1,1)*M1(2,2)-M1(1,2)*M1(2,1))/MDET;
  10024     M2(1,3):=(M1(1,2)*M1(2,3)-M1(1,3)*M1(2,2))/MDET;
  10025     M2(3,1):=(M1(2,1)*M1(3,2)-M1(2,2)*M1(3,1))/MDET;
  10026     M2(1,2):=-(M1(1,2)*M1(3,3)-M1(1,3)*M1(3,2))/MDET;
  10027     M2(2,1):=-(M1(2,1)*M1(3,3)-M1(2,3)*M1(3,1))/MDET;
  10028     M2(2,3):=-(M1(1,1)*M1(2,3)-M1(1,3)*M1(2,1))/MDET;
  10029     M2(3,2):=-(M1(1,1)*M1(3,2)-M1(1,2)*M1(3,1))/MDET;
  10030     ENDPROCEDURE;
  10031   PROCEDURE SMR NAP LAP ;
  10032     VARIABLE COD 1 NV ;
  10033     VARIABLE NUM 1 ;
  10034     VARIABLE I 1 ;
  10035     VARIABLE J 1 ;
  10036     VARIABLE MM NM1 3 3 ;
  10037     VARIABLE T1 NM1 1 ;
  10038     VARIABLE T2 NM1 1 ;
  10039     VARIABLE FLG 1 ;
  10040     NUM := MIN(TWOND,4) ; %MIN:  207
  10041     MATINV NAP MM ; %MATINV:10015
  10042     MM(1,3) := -MM(1,3) ;
  10043     MM(2,3) := -MM(2,3) ;
  10044     MM(3,1) := -MM(3,1) ;
  10045     MM(3,2) := -MM(3,2) ;
  10046     LOOP I 2 NUM 2 ;
  10047       COD(I-1) := DD(I-1) ;
  10048       COD(I) := -DD(I) ;
  10049       ENDLOOP ;
  10050     LOOP I NUM+1 NV ;
  10051       COD(I) := DD(I) ;
  10052       ENDLOOP ;
  10053     IF ND>2 ;
  10054       COD(5) := -DD(5) ;
  10055       ENDIF ;
  10056     LOOP I 1 3 ;
  10057       LOOP J 1 3 ;
  10058         T1(1) := MM(I,J) ;
  10059         POLVAL 1 T1 1 COD NV T2 1 ;
  10060         LAP(I,J) := T2(1) ;
  10061         ENDLOOP ;
  10062       ENDLOOP ;
  10063     ENDPROCEDURE ;
  10064   PROCEDURE TRACK PNTNUM STEP FILEDIR MARK TY;
  10065     VARIABLE TURN 1;
  10066     VARIABLE PNT 1;
  10067     VARIABLE PCT 1;
  10068     VARIABLE SYMPE 1;
  10069     VARIABLE SNRME 1;
  10070     WRITE 6 'RUNNING COSYINF-CORE/UTILITIES.FOX: TRACK';
  10071     OPENF 100500 FILENAME(FILEDIR, 'PRAY', 'TR'&MARK) 'REPLACE'; %FILE
                  NAME: 9778
  10072     PRAY 100500; %PRAY: 2299
  10073     CLOSEF 100500;
  10074     WRITE 6 SI(0)&' %'; %SI:  288
  10075     OPENF 100501 FILENAME(FILEDIR, 'TRPSPI', 'TR'&MARK) 'REPLACE'; %FI
                  LENAME: 9778
  10076     WRITE 100501 '# TRACKING OUTPUT';
  10077     WRITE 100501 'TURN PID S_X S_Y S_Z';
  10078     WRITETBL 100501 SPI 3 SF(0, '(I15)'); %WRITETBL: 9798 %SF:  285
  10079     OPENF 100502 FILENAME(FILEDIR, 'TRPRAY', 'TR'&MARK) 'REPLACE'; %FI
                  LENAME: 9778
  10080     WRITE 100502 '# TRACKING OUTPUT';
  10081     WRITE 100502 'TURN PID X A Y B T D';
  10082     WRITETBL 100502 RAY 6 SF(0, '(I15)'); %WRITETBL: 9798 %SF:  285
  10083     TRR 1; %TRR: 5317
  10084     OPENF 101239 'tmp/ERROR:TRACK.txt' 'REPLACE';
  10085     WRITE 101239 '# NUM SYMPE SNRME';
  10086     LOOP PNT 1 PNTNUM;
  10087       TURN := STEP*PNT;
  10088       TR STEP -STEP -1 -3 1.1 1.1 TY 0 -12; %TR: 4756
  10089       WRITETBL 100501 SPI 3 SF(TURN, '(I15)'); %WRITETBL: 9798 %SF:  2
                  85
  10090       WRITETBL 100502 RAY 6 SF(TURN, '(I15)'); %WRITETBL: 9798 %SF:  2
                  85
  10091       PCT := 100*PNT/PNTNUM;
  10092       IF MOD(PCT, 10)=0; %MOD:  210
  10093         WRITE 6 SI(PCT)&' %'; %SI:  288
  10094         ENDIF;
  10095       TRSC SYMPE; %TRSC: 4750
  10096       TRNC SNRME; %TRNC: 4753
  10097       WRITE 6 '   TR SYMPLECTIFICATION ERROR' SYMPE;
  10098       WRITE 6 '   TR SPIN NORMALIZATON ERROR' SNRME;
  10099       WRITE 101239 SF(TURN, '(I10)')&SF(SYMPE, '(E15.7)')&SF(SNRME, '(
                  E15.7)'); %SF:  285 %SF:  285 %SF:  285
  10100       IF (SYMPE > 1E-3);
  10101         WRITE 6 'SYMPLECTIFICATION ERROR TOO LARGE; ABORTING...';
  10102         QUIT TURN;
  10103         ELSEIF (SNRME > 1E-3);
  10104         WRITE 6 'SPIN NORMALIZATION ERROR TOO LARGE; ABORTING...';
  10105         QUIT TURN;
  10106         ENDIF;
  10107       ENDLOOP;
  10108     CLOSEF 101239;
  10109     CLOSEF 100500;
  10110     CLOSEF 100501;
  10111     CLOSEF 100502;
  10112     ENDPROCEDURE;
  10113   PROCEDURE SMAPS POS MAPARR SPNRARR;
  10114     VARIABLE I 1;
  10115     VARIABLE J 1;
  10116     LOOP I 1 TWOND;
  10117       MAPARR(I, POS) := MAP(I);
  10118       ENDLOOP;
  10119     LOOP I 1 3;
  10120       LOOP J 1 3;
  10121         SPNRARR(I,J,POS) := SPNR(I,J);
  10122         ENDLOOP;
  10123       ENDLOOP;
  10124     ENDPROCEDURE;
  10125   PROCEDURE LMAPS POS MAPARR SPNRARR;
  10126     VARIABLE I 1;
  10127     VARIABLE J 1;
  10128     UM; %UM: 1488
  10129     LOOP I 1 TWOND;
  10130       MSC(I) := MAPARR(I, POS);
  10131       ENDLOOP;
  10132     LOOP I 1 3;
  10133       LOOP J 1 3;
  10134         SSCR(I,J) := SPNRARR(I,J,POS) + 0*DD(1);
  10135         ENDLOOP;
  10136       ENDLOOP;
  10137     LOCSET 0 0 0 0 0 0; %LOCSET: 1114
  10138     UPDATE 1 1; %UPDATE: 1261
  10139     ENDPROCEDURE;
  10140   PROCEDURE TREL MAPARR SPNRARR IEL LEL NTRN PRAYOU PSPIOU;
  10141     VARIABLE TRN 1;
  10142     VARIABLE EL 1;
  10143     VARIABLE NR 1;
  10144     VARIABLE NS 1;
  10145     VARIABLE DUM 1;
  10146     VARIABLE I 1;
  10147     VARIABLE SYMPE 1;
  10148     VARIABLE SNRME 1;
  10149     VARIABLE MAPSE 1;
  10150     VARIABLE RAYH 1000 8;
  10151     VARIABLE SPIH 1000 3;
  10152     PROCEDURE WTRPRAY IT ELN;
  10153       VARIABLE STR 500;
  10154       VARIABLE J 1;
  10155       VARIABLE I 1;
  10156       IF PRAYOU#0;
  10157         IF IT=0 ;
  10158           NR := LENGTH(RAY(1));
  10159           IF NR=1;
  10160             NR:=0;
  10161             ENDIF;
  10162           WRITE PRAYOU '# number of rays:'&SF(NR,'(I8)') ; %SF:  285
  10163           IF NR>0 ;
  10164             STR := '# iteration   EID   ray    X              A' ;
  10165             IF TWOND>2 ;
  10166               STR := STR&'              Y              B' ;
  10167               ENDIF ;
  10168             IF TWOND>4 ;
  10169               STR := STR&'              T              D' ;
  10170               ENDIF ;
  10171             IF TWOND>6 ;
  10172               STR := STR&'              G              Z' ;
  10173               ENDIF ;
  10174             WRITE PRAYOU STR ;
  10175             ENDIF ;
  10176           ELSEIF TRUE ;
  10177           WRITE PRAYOU '' ;
  10178           ENDIF ;
  10179         LOOP J 1 NR ;
  10180           STR := SF(IT,'(I10)')&SF(ELN,'(I6)')&' '&SF(J-1,'(I6)') ; %S
                  F:  285 %SF:  285 %SF:  285
  10181           LOOP I 1 TWOND ;
  10182             STR := STR&SF((RAY(I)|J),'(E15.7)') ; %SF:  285
  10183             ENDLOOP ;
  10184           WRITE PRAYOU STR ;
  10185           ENDLOOP ;
  10186         ENDIF;
  10187       ENDPROCEDURE;
  10188     PROCEDURE WTRPSPI IT ELN;
  10189       VARIABLE STR 500;
  10190       VARIABLE I 1;
  10191       VARIABLE J 1;
  10192       IF PSPIOU#0;
  10193         IF IT=0 ;
  10194           NS := LENGTH(SPI(1)) ;
  10195           IF NS=1 ;
  10196             NS := 0 ;
  10197             ENDIF ;
  10198           WRITE PSPIOU '# number of spin vectors:'&SF(NS,'(I8)') ; %SF
                  :  285
  10199           IF NS>0 ;
  10200             WRITE PSPIOU ('# iteration   EID vector   S_X'&           
                               '            S_Y            S_Z') ;
  10201             ENDIF ;
  10202           ELSEIF TRUE ;
  10203           WRITE PSPIOU '' ;
  10204           ENDIF ;
  10205         LOOP J 1 NS ;
  10206           STR := SF(IT,'(I10)')&SF(ELN, '(I6)')&' '&SF(J-1,'(I6)') ; %
                  SF:  285 %SF:  285 %SF:  285
  10207           LOOP I 1 3 ;
  10208             STR := STR&SF((SPI(I)|J),'(E15.7)') ; %SF:  285
  10209             ENDLOOP ;
  10210           WRITE PSPIOU STR ;
  10211           ENDLOOP ;
  10212         ENDIF;
  10213       ENDPROCEDURE;
  10214     TRR 1; %TRR: 5317
  10215     LTRPRAY := 0;
  10216     LTRPSPI := 0;
  10217     WTRPRAY 0 0; %WTRPRAY:10152
  10218     WTRPSPI 0 0; %WTRPSPI:10188
  10219     SRAY RAYH; %SRAY: 2442
  10220     SSPI SPIH; %SSPI: 2624
  10221     OPENF 101239 'tmp/ERROR:TREL.txt' 'REPLACE';
  10222     WRITE 101239 '# TRN EL SYMPE SNRME MAPSE';
  10223     LOOP TRN 1 NTRN;
  10224       LOOP EL IEL LEL;
  10225         WRITE 6 'ELEMENT NUMBER '&ST(EL);
  10226         UM; %UM: 1488
  10227         CR; %CR:  947
  10228         LMAPS EL MAPARR SPNRARR; %LMAPS:10125
  10229         LRAY RAYH; %LRAY: 2448
  10230         LSPI SPIH; %LSPI: 2630
  10231         TRSC SYMPE; %TRSC: 4750
  10232         TRNC SNRME; %TRNC: 4753
  10233         MAPSE := SE(MAP); %SE: 3017
  10234         TR 1 -1 -1 -3 1.2 1.2 0 0 -12; %TR: 4756
  10235         WTRPRAY TRN EL; %WTRPRAY:10152
  10236         WTRPSPI TRN EL; %WTRPSPI:10188
  10237         SRAY RAYH; %SRAY: 2442
  10238         SSPI SPIH; %SSPI: 2624
  10239         WRITE 101239 SF(TRN, '(I10)')&SF(EL, '(I10)')&SF(SYMPE, '(E15.
                  7)')&SF(SNRME, '(E15.7)')&SF(MAPSE, '(E15.7)'); %SF:  285 %S
                  F:  285 %SF:  285 %SF:  285 %SF:  285
  10240         ENDLOOP;
  10241       ENDLOOP;
  10242     CLOSEF 101239;
  10243     ENDPROCEDURE;
  10244   PROCEDURE COLWRITE OU VEC;
  10245     VARIABLE N 1;
  10246     VARIABLE I 1;
  10247     N := LENGTH(VEC);
  10248     LOOP I 1 N;
  10249       WRITE OU VEC|I;
  10250       ENDLOOP;
  10251     ENDPROCEDURE;
  10252   PROCEDURE INSERT POS MAPARR SPNRARR NFILLED;
  10253     VARIABLE I 1;
  10254     VARIABLE J 1;
  10255     VARIABLE K 1;
  10256     LOOP I NFILLED POS -1;
  10257       WRITE 6 I;
  10258       LOOP J 1 TWOND;
  10259         MAPARR(J, I+1) := MAPARR(J, I);
  10260         ENDLOOP;
  10261       LOOP J 1 3;
  10262         LOOP K 1 3;
  10263           SPNRARR(J, K, I+1) := SPNRARR(J, K, I);
  10264           ENDLOOP;
  10265         ENDLOOP;
  10266       ENDLOOP;
  10267     SMAPS POS MAPARR SPNRARR; %SMAPS:10113
  10268     ENDPROCEDURE;
 --- BIN FILE WRITTEN: utilities
  10269   SAVE 'utilities';
